set -g default-terminal "${TERM}"

# Undercurl
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0

# Reload config with a key
bind-key r source-file ~/.config/tmux/.tmux.conf \; display "Config reloaded!"

# Start numbering at 1
set -g base-index 1

# Automatically renumber tmux windows on close
set -g renumber-windows on

# Prevent tmux auto rename
set -g allow-rename off

# Set C-a as prefix
unbind C-b
set -g prefix C-a
bind-key C-a send-prefix

# Fix nvim escape
set -s escape-time 0

# Stay in directory on slits
bind '%' split-window -h -c '#{pane_current_path}'  # Split panes horizontal
bind '"' split-window -v -c '#{pane_current_path}'  # Split panes vertically
bind c new-window -c '#{pane_current_path}' # Create new window

# Shift-movement keys will resize panes
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# Navigate using vim-style keys
setw -g mode-keys vi

# Unbind arrow keys
unbind Up
unbind Down
unbind Right
unbind Left

# Constrain window size to the maximum of any client connected to that
# window.
setw -g aggressive-resize on

# tmux battery
set -g @batt_icon_charge_tier8 ""
set -g @batt_icon_charge_tier7 ""
set -g @batt_icon_charge_tier6 ""
set -g @batt_icon_charge_tier5 ""
set -g @batt_icon_charge_tier4 ""
set -g @batt_icon_charge_tier3 ""
set -g @batt_icon_charge_tier2 ""
set -g @batt_icon_charge_tier1 ""
set -g @batt_icon_status_charged " "
set -g @batt_icon_status_charging "  "
set -g @batt_icon_status_discharging " "
set -g @batt_icon_status_attached " "
set -g @batt_icon_status_unknown " "


source-file ~/.config/tmux/light.conf

# Statusline
set -g status on
set -g status-justify centre
set -g status-position bottom
setw -g mode-style bg=$color_purple,fg=$color_bg
setw -g window-status-separator "   "
set -g status-style "bg=$color_fg"
set -g message-style bg=$color_blue,fg=$color_bg
set -g status-left "#[fg=$color_gray]#(hostname)"
set -g status-right "#[fg=$color_gray]#{battery_icon_charge}  #{battery_percentage}#{battery_icon_status}"

setw -g window-status-format "#[fg=$color_gray,italics]#I #[noitalics]#W  "
setw -g window-status-current-format "#[fg=$color_purple,italics]• #[noitalics,bold]#W  "

set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'aserowy/tmux.nvim'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
